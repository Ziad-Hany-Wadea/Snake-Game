(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9460],{44725:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/replEnvironment2",function(){return n(75819)}])},75819:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return jo}});var r=n(34051),i=n.n(r),o=n(35944),a=n(67294),l=n(91131),c=n(11163),u=n(17221),s=n(36526),d=n(91700),f=n(27740),p=n.n(f),v=n(88768),h=n(23139),y=n(79523),m=n(22315),g=n(37156),b=n(56834),w=n(41664),Z=n.n(w),x=n(62873),I=n(4590),E=n(30617),S=n(49337),k=n(88341),C=n(25398),P=n(50553),A=n(61305),O=n(87784),D=n(33217),R=n(83347),j=n(74255);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){M(e,t,n[t])}))}return e}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(){return(0,o.tZ)(h.G7,{children:(0,o.tZ)(h.G7,{"aria-label":"Always on","data-microtip-position":"bottom",role:"tooltip",css:[h.l0.width(8),h.l0.height(8),h.l0.borderRadius("full"),h.l0.backgroundColor.accentPositiveDefault,{alignSelf:"start",boxShadow:"0 0 12px "+h.TV.accentPositiveDefault}]})})}function z(e){var t,n=e.repl,r=e.refetch,i=(0,c.useRouter)(),l=U(a.useState(!1),2),u=l[0],s=l[1],d=(0,v.koY)().data,f=function(e){if(n&&(!!e.title&&e.title!==n.title)){var t=(0,C.Z)(i.query);i.push({pathname:i.pathname,query:G({},i.query,{replUrl:n.url})},{pathname:n.url,query:t},{shallow:!0})}};return(0,o.BX)(k.Z,{isOpen:u,maxWidth:460,onClickOutside:function(){},padding:0,placement:"bottom-start",growToMaxWidth:!0,zIndex:j.I-1,elevated:!1,children:[(0,o.BX)(h.G7,{tag:"button","data-cy":"ws-repl-info-container",onClick:function(){s(!0)},css:[h.l0.align.center,h.l0.cursor.pointer,h.l0.rowWithGap(8),h.l0.p(4),h.l0.borderRadius(8),h.l0.color.foregroundDefault,u&&{pointerEvents:"none"},{border:"1px solid transparent",backgroundColor:"transparent","&:hover":{borderColor:h.TV.outlineDimmest}}],children:[(0,o.tZ)(A.Z,{user:n.user}),(0,o.tZ)(D.Z,{repl:n}),n.isAlwaysOn?(0,o.tZ)(_,{}):null,(0,o.tZ)(h.G7,{css:[h.l0.p(4)],children:(0,o.tZ)(P.Z,{})})]}),(null===d||void 0===d||null===(t=d.currentUser)||void 0===t?void 0:t.hasFlagBuyCyclesGate)?(0,o.tZ)(R.Sq,{setIsEditing:s,repl:n,refetch:r,onUpdateRepl:f}):(0,o.tZ)(O.Z,{setIsEditing:s,repl:n,refetch:r,onUpdateRepl:f})]})}var F=n(57337),B=n(22944),N=n(43713),L=n(45193),K=n(7177),W=n(27545),V=n(32547),X=n(60789),H=n(5560),q=n(18172),Y=n(71171),$=n.n(Y),Q=n(29632),J=n(47865),ee=n(23880);function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,l.cn)(null,(function(e,t,n){var r=e(Q.Eh).find((function(e){return e.isDialog}));r?t(J.$r,r.paneId):t(re,n)}));var ne=(0,l.cn)(null,(function(e,t,n){var r=e(Q.Eh).find((function(e){return e.isDialog}));if(r){var i=e(r.data);i.type!==i.type?(t(J.$r,r.paneId),t(re,n)):t(J.vN,{paneId:r.paneId,data:n.pane})}else t(re,n)})),re=(0,l.cn)(null,(function(e,t,n){if(!e(Q.Eh).find((function(e){return e.isDialog}))){var r=e(Q.g4),i=e(Q.CK),o=$()(),a=i.x+i.width,l=i.y+i.height,c=n.maxWidth||a,u=n.maxHeight||l,s=Math.min(c,.8*a),d=Math.min(u,.8*l),f={width:s,height:d,x:a/2-s/2-i.x,y:l/2-d/2-i.y},p=(0,q.ZP)(r,(function(e){(0,ee.mZ)(e,{isFloating:!0,panes:[o],rect:f})}));t(Q.YF,p),t(Q.W1,{paneId:o});var v=(0,Q.z)(o),h=e(v);t(Q.W1,{paneId:o}),t(v,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){te(e,t,n[t])}))}return e}({},h,{isDialog:!0})),t(h.data,n.pane)}})),ie=(0,l.cn)(null,(function(e,t){var n=e(Q.Eh).find((function(e){return e.isDialog}));n&&t(J.$r,n.paneId)})),oe=n(45823),ae=n(88503),le=n(18056),ce=n(33468),ue=n(1619),se=n(36107),de=n(43151),fe=n(52620),pe=n(30478),ve=n(50876),he=n(39473),ye=n(94982),me=n(61069),ge=n(44660),be=n(72839),we=n(70445),Ze=n(70636);function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ee=(0,h.KD)("a"),Se=[v.Sy.Submit,v.Sy.Resubmit,v.Sy.UpdateModelSolution,v.Sy.PublishTemplate,v.Sy.EditTemplate,v.Sy.ReviewSubmission],ke={cmdOrCtrlKey:!0,altKey:!1,shiftKey:!0,key:"M"};function Ce(){var e,t,n,r,i,c=(0,E.Z)(),u=c.runner,s=c.presence,d=c.replbox,f=c.session,p=(0,H.Z)(),y=(0,S.Z)({presence:s}),m=Ie(a.useState(!1),2),g=m[0],w=m[1],k=Ie(a.useState(!1),2),C=k[0],P=k[1],A=Ie(a.useState(!1),2),O=A[0],D=A[1],R=Ie(a.useState(u),2),j=R[0],T=R[1],M=Ie(a.useState(!1),2),G=M[0],U=M[1],_=(0,me.e)(ge.H.Run),q=(0,me.e)(ge.H.Share),Y=(0,v.ggE)({variables:{id:p}}),$=Y.data,Q=Y.refetch,J=(0,l.b9)(ne),ee=(0,be.Z)(),te=(0,l.b9)(le.cN),re="Repl"===(null===$||void 0===$?void 0:$.repl.__typename)?$.repl:null,ie=null===$||void 0===$?void 0:$.currentUser,xe="replbox"===(null===re||void 0===re||null===(e=re.lang)||void 0===e?void 0:e.engine)&&"html"!==(null===re||void 0===re?void 0:re.lang.id);(0,a.useEffect)((function(){T(xe?d:u)}),[xe,d,u]);var Ce=(0,a.useRef)(null),Pe=(0,a.useRef)(null),Ae=(0,a.useRef)(G&&(null===q||void 0===q?void 0:q.isActive));(0,a.useEffect)((function(){Ae.current&&!(null===q||void 0===q?void 0:q.isActive)&&U(!1),Ae.current=G&&(null===q||void 0===q?void 0:q.isActive)}),[q,G]),(0,a.useEffect)((function(){(null===q||void 0===q?void 0:q.isActive)&&(G&&Pe.current?null===q||void 0===q||q.delegateTooltip(Pe.current):q.delegateTooltip(Ce.current))}),[q,G,Pe]);var Oe="Team"===(null===re||void 0===re||null===(t=re.owner)||void 0===t?void 0:t.__typename),De=Boolean("Team"===(null===re||void 0===re||null===(n=re.owner)||void 0===n?void 0:n.__typename)&&(null===(r=null===re||void 0===re?void 0:re.owner.capabilities)||void 0===r?void 0:r.isEducationPlan)),Re=Se.find((function(e){return e===(null===re||void 0===re?void 0:re.workspaceCta)})),je=!(null===re||void 0===re?void 0:re.publishedAs),Te=null===re||void 0===re?void 0:re.currentUserPermissions.publish,Me=(null===re||void 0===re?void 0:re.publishedAs)===v.O2h.Template,Ge=(null===re||void 0===re?void 0:re.publishedAs)===v.O2h.RegularRepl,Ue=!De&&(null===re||void 0===re?void 0:re.currentUserPermissions.editMultiplayers);return(0,de.x)(ke,{enabled:!De,run:function(){U(!0)}}),(0,ce.Y)({match:se.pl,data:{type:"action",label:"Multiplayer",icon:(0,o.tZ)(ue.Z,{}),description:"Open multiplayer mode",run:function(){U(!0)},keyboardShortcut:ke}},{enabled:!De}),(0,a.useEffect)((function(){return s.onUserOpenedFile((function(e){var t=e.user,n=e.file,r=s.getFollowedUser();r&&r.id===t.id&&n&&f.openFile(n)}))}),[s,f]),re?(0,o.BX)(h.Tg,{elevated:!0,tag:"header",css:[h.l0.height(60),h.l0.rowWithGap(8),h.l0.align.center,h.l0.justify.spaceBetween,h.l0.p(8),h.l0.position.relative,h.l0.pl(48)],children:[(0,o.BX)(h.G7,{css:[h.l0.rowWithGap(4),h.l0.center],children:[(0,o.tZ)(h.G7,{css:[h.l0.p(8),h.l0.pl(0)],children:(0,o.tZ)(Z(),{as:"/~",href:"/home",passHref:!0,children:(0,o.tZ)(Ee,{css:[h.l0.center,h.l0.color.foregroundDefault,h.l0.width(32),h.l0.height(32)],children:(0,o.tZ)(x.Z,{})})})}),(null===ie||void 0===ie?void 0:ie.isFirewallMode)&&(0,o.tZ)(we.Z,{isWorkspace:!0}),(0,o.BX)(h.G7,{css:[h.l0.rowWithGap(4),h.l0.align.center],children:[(0,o.tZ)(z,{repl:re,refetch:Q}),(0,o.tZ)(B.Z,{repl:re,canEdit:re.currentUserPermissions.containerWrite})]})]}),(0,o.tZ)(h.G7,{innerRef:null===_||void 0===_?void 0:_.delegateTooltip,"data-cy":"ws-run-btn",onClick:function(){(null===_||void 0===_?void 0:_.isActive)&&_.next()},css:[h.l0.position.absolute,h.l0.height(42),{transform:"translate(-50%, -50%)",left:"50%",top:"50%"}],children:(0,o.tZ)(F.Z,{runner:j,disableTooltip:null===_||void 0===_?void 0:_.isActive})}),(0,o.BX)(h.G7,{css:[h.l0.rowWithGap(8),h.l0.align.center,h.l0.justify.end],children:[y&&y.length>0?(0,o.tZ)(N.Z,{users:y,onAvatarClick:ee}):null,(null===ie||void 0===ie?void 0:ie.isExplorer)?(0,o.tZ)(Ze.Z,{}):null,Re?(0,o.tZ)(h.G7,{css:[h.l0.pr(8)],children:(0,o.tZ)(oe.Z,{cta:Re,replId:p,isGroupProject:Boolean(null===re||void 0===re||null===(i=re.template)||void 0===i?void 0:i.isGroupProject),openIOtesterPane:function(){J({pane:{type:"autograder"}})}})}):null,Te&&je?(0,o.tZ)(h.zx,{type:"button",iconLeft:(0,o.tZ)(fe.Z,{}),onClick:function(){w(!0)},"data-cy":"ws-publish-button",text:"Publish"}):null,Me?(0,o.tZ)(h.zx,{type:"button",iconLeft:(0,o.tZ)(fe.Z,{}),onClick:function(){return P(!0)},text:"Update"}):null,Ge?(0,o.tZ)(h.zx,{type:"button",iconLeft:(0,o.tZ)(pe.Chat,{}),onClick:function(){return D(!0)},text:"Update"}):null,Ue?(0,o.tZ)(h.G7,{innerRef:Ce,children:(0,o.tZ)(V.Z,{showPopover:re.currentUserPermissions.inviteGuests,children:(0,o.tZ)(h.zx,{onClick:function(){(0,b.j)(b.U3.INVITE_MODAL_OPENED,{language:re.lang.id,replId:re.id,source:"replEnvironment"}),U(!0)},iconLeft:(0,o.tZ)(I.Z,{}),text:"Invite"})})}):null,(0,o.tZ)(h.hU,{size:28,onClick:function(){te()},tooltipDelay:500,alt:"Search & run commands",tooltipPlacement:"bottom-end",children:(0,o.tZ)(ae.Z,{})})]}),(0,o.tZ)(L.Z,{isOpen:G,onRequestClose:function(){return U(!1)},children:(0,o.tZ)(h.G7,{innerRef:Pe,children:Oe?(0,o.tZ)(W.Z,{replId:p}):(0,o.tZ)(X.Z,{replId:p})})}),(0,o.tZ)(K.Z,{isOpen:g,onRequestClose:function(){return w(!1)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,o.tZ)(ve.Z,{source:"replEnvironment",replId:re.id})}),(0,o.tZ)(K.Z,{isOpen:C,onRequestClose:function(){return P(!1)},children:(0,o.tZ)(ye.Z,{repl:re})}),(0,o.tZ)(K.Z,{isOpen:O,onRequestClose:function(){return D(!1)},children:(0,o.tZ)(he.Z,{repl:re,onDone:function(){return D(!1)},source:"replEnvironment"})})]}):(0,o.tZ)(h.G7,{tag:"header",css:[h.l0.backgroundColor.backgroundDefault,h.l0.height(60)]})}var Pe=(0,a.memo)(Ce),Ae=n(92876),Oe=n(76890),De=n(1933),Re=n(98009),je=n(35932),Te=n(38848),Me=n(25108);var Ge=n(1517),Ue=n(15682),_e=n(71227),ze=n(12603),Fe=n(94157),Be=n(66919),Ne=n(44262),Le=n(73248),Ke=n(57731),We=n(15866),Ve=n(27248),Xe=n(81970),He=n(8286),qe=n(79806),Ye=n(34996),$e=n(90544),Qe=n(51281),Je=n(58458),et=n(8996),tt=n(40425),nt=n(43552),rt=n(3204);function it(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function ot(e){var t=e.isVisible,n=e.children,r=e.onDismiss,l=(0,H.Z)(),c=(0,E.Z)().fs,u=(0,nt.Z)("workspace","enveditorintro"),s=u.shouldDisplay,d=u.register,f=u.dismiss;return a.useEffect((function(){var e=!1,n=function(){var n,r=(n=i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.readFile(".env");case 2:if(r=n.sent,!e){n.next=5;break}return n.abrupt("return");case 5:if(!r.error){n.next=7;break}return n.abrupt("return");case 7:t&&d();case 8:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function a(e){it(o,r,i,a,l,"next",e)}function l(e){it(o,r,i,a,l,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();return n(),function(){e=!0}}),[l,c,t,d]),(0,o.tZ)("div",{css:[rt.l0.display.flex,rt.l0.width("100%"),rt.l0.height("100%"),rt.l0.center],children:(0,o.BX)(k.Z,{isOpen:s,placement:"right",showArrow:!0,children:[a.cloneElement(n,{tooltipHidden:s}),(0,o.BX)(et.gC,{spacing:1,align:"stretch",children:[(0,o.tZ)(tt.Z,{level:4,children:"Looking for your .env file?"}),(0,o.tZ)(Je.Z,{size:"small",children:"Your environment moved here, click on the icon to the left to check it out and edit your environment."}),(0,o.tZ)(et.Ug,{justify:"end",children:(0,o.tZ)(Qe.Z,{color:"primary",onClick:function(e){e.stopPropagation(),f(),r()},children:"dismiss"})})]})]})})}var at=n(64457),lt=n(84637),ct=n(40383);function ut(e,t){var n=t.leftPath,r=t.percent,i=t.snapPercent,o=void 0===i?0:i,a=(0,lt.K)(e,n);if(!a||!(0,ct.r)(a))throw new Error("Expected leftNode");var l=(0,ct.I)(n),c=(0,lt.K)(e,l);if("split"!==(null===c||void 0===c?void 0:c.type))throw new Error("Expected splitNode");var u=c.children.indexOf(a);if(-1===u)throw new Error("Expected leftNodeIndex");var s=u+1,d=c.children[s];if(!d)throw new Error("Expected rightNode");if(r<=o){if(a.percent=0,r<0&&u>0)for(var f=Math.abs(r),p=u-1;f>0;){var v=c.children[p];if(v.percent>f){v.percent-=f;break}if(f-=v.percent,v.percent=0,0===p)break;p--}var h=c.children.reduce((function(e,t){return t===d?e:e+t.percent}),0);d.percent=100-h}else{var y=a.percent+d.percent,m=c.children.slice(u).reduce((function(e,t){return e+t.percent}),0);if(r>y-o){if(a.percent=Math.min(m,Math.max(y,r)),d.percent=0,r>y&&s<c.children.length-1)for(var g=r-y,b=s+1;g>0;){var w=c.children[b];if(w.percent>g){w.percent-=g;break}if(g-=w.percent,w.percent=0,b===c.children.length-1)break;b++}}else{var Z=a.percent-r;d.percent=d.percent+Z,a.percent=r}}}var st=n(64824),dt=(0,l.cn)(null,(function(e,t,n){var r=e(Q.g4),i=(0,q.ZP)(r,(function(e){ut(e,{leftPath:n.leftPath,percent:n.percent})}));t(Q.YF,i)}));var ft=n(44894);function pt(e){var t,n,r=e.isVisible,i=e.children,l=e.onDismiss,c=(0,H.Z)(),u=(0,v.CHr)({variables:{replId:c}}),s=u.data,d=u.loading,f="io-tests-popover-dismissed-".concat(c),p=ft.Z.get(f,"boolean");if(!s||d)return null;var h="Repl"===(null===s||void 0===s||null===(t=s.repl)||void 0===t?void 0:t.__typename)?s.repl:null;if(!h)return null;var y=h.isProjectFork,m=h.ioTests,g=h.owner,b=(null===(n=h.unitTests)||void 0===n?void 0:n.tests)?h.unitTests.tests:[],w="Team"===(null===g||void 0===g?void 0:g.__typename)&&(null===g||void 0===g?void 0:g.isAdmin),Z=m.length>0||b.length>0,x=!w&&y&&!p&&Z&&r;return(0,o.tZ)("div",{css:[rt.l0.display.flex,rt.l0.width("100%"),rt.l0.height("100%"),rt.l0.center],children:(0,o.BX)(k.Z,{isOpen:x,placement:"right",showArrow:!0,borderColor:"var(--accent-purple-default)",children:[a.cloneElement(i,{tooltipHidden:x}),(0,o.BX)(et.gC,{spacing:1,align:"stretch",children:[m.length>0?(0,o.BX)(Je.Z,{size:"small",children:["This project has ",(0,o.tZ)("strong",{children:m.length})," input/output"," ",m.length>1?"tests":"test","."]}):(0,o.BX)(Je.Z,{size:"small",children:["This project has ",(0,o.tZ)("strong",{children:b.length})," unit"," ",b.length>1?"tests":"test","."]}),(0,o.tZ)(Je.Z,{size:"small",children:"Run tests to check your work!"}),(0,o.tZ)(et.Ug,{justify:"end",children:(0,o.tZ)(Qe.Z,{onClick:function(e){e.stopPropagation(),ft.Z.set(f,!0),l()},children:"dismiss"})})]})]})})}var vt=n(90361);function ht(){var e,t=(0,H.Z)(),n=(0,v.iw1)({variables:{replId:t}}).data,r="Repl"===(null===n||void 0===n||null===(e=n.repl)||void 0===e?void 0:e.__typename)?null===n||void 0===n?void 0:n.repl:null;return r?{repl:r,currentUser:(null===n||void 0===n?void 0:n.currentUser)||null}:{repl:null,currentUser:null}}function yt(){var e=ht().repl,t=(0,l.b9)($e.ye),n=(0,l.b9)($e.jw),r=null===e||void 0===e?void 0:e.lang.hasDAP,i=function(){var e=(0,E.Z)().dotReplit,t=(0,a.useState)(!1),n=t[0],r=t[1];return(0,a.useEffect)((function(){return e.watch((function(e){var t,n;e.error?e.error===vt.Yt.NotFound&&r(!1):r(Boolean(null===e||void 0===e||null===(t=e.config)||void 0===t||null===(n=t.debugger)||void 0===n?void 0:n.support))}))})),n}();(0,a.useEffect)((function(){r||i?t({type:"debugger",icon:(0,o.tZ)(Ke.Z,{}),tooltip:"Debugger"}):n("debugger")}),[r,i,t,n])}var mt=!1;function gt(){var e=(0,l.Dv)($e.nv),t=(0,l.Dv)($e.sz),n=(0,l.b9)($e.zN);return function(){var e=(0,l.b9)($e.ye),t=(0,l.b9)($e.jw),n=(0,at.e)().isTutorial,r=(0,l.b9)($e.zN),i=(0,l.b9)(dt);(0,a.useEffect)((function(){if(n)return e({type:"tutorial",icon:(0,o.tZ)(Ne.Z,{}),tooltip:"Tutorial"}),r("tutorial"),void i({leftPath:["tiling",0],percent:25});t("tutorial")}),[n,t,e,r,i])}(),function(){var e=(0,l.b9)($e.ye),t=(0,l.b9)($e.jw),n=(0,ze.oj)(),r=(0,at.e)().isTutorial,i=(0,l.b9)($e.zN);(0,a.useEffect)((function(){if(n)return e({type:"kaboombar",icon:(0,o.tZ)(qe.Z,{}),tooltip:"Kaboom"}),void(r||i("kaboombar"));t("kaboombar")}),[n,r,t,e,i])}(),function(){var e,t=(0,l.b9)($e.ye);(0,a.useEffect)((function(){t({type:"filetree",icon:(0,o.tZ)(Fe.Z,{}),tooltip:"Files"})}),[t]);var n=(0,l.b9)($e.Wp),r=null===(e=(0,me.e)(ge.H.Sidepane))||void 0===e?void 0:e.isActive;(0,a.useEffect)((function(){if(r){var e=setInterval((function(){n("filetree")}),200);return function(){clearInterval(e)}}}),[r,n])}(),function(){var e=ht().repl,t=(0,l.b9)($e.ye),n=(0,l.b9)($e.jw),r=Boolean(null===e||void 0===e?void 0:e.lang.supportsGit);(0,a.useEffect)((function(){r?t({type:"git",icon:(0,o.tZ)(Le.Z,{}),tooltip:"Version control"}):n("git")}),[r,n,t])}(),function(){var e=(0,l.b9)($e.ye),t=(0,l.b9)($e.jw),n=(0,_e.x)();(0,a.useEffect)((function(){(null===n||void 0===n?void 0:n.packageSearch)?e({type:"packager",tooltip:"Packager",icon:(0,o.tZ)(Be.Z,{})}):t("packager")}),[n,e,t])}(),function(){var e=ht().repl,t=(0,l.b9)($e.ye),n=(0,l.b9)($e.jw),r=e&&!(null===e||void 0===e?void 0:e.lang.key.startsWith("html"));(0,a.useEffect)((function(){r?t({type:"envEditor",icon:(0,o.tZ)(We.Z,{}),IconWrapper:ot,tooltip:"Secrets (Environment variables)"}):n("envEditor")}),[r,t,n])}(),yt(),function(){var e=ht().repl,t=(0,l.b9)($e.ye),n=(0,l.b9)($e.jw),r=e&&!(null===e||void 0===e?void 0:e.lang.key.startsWith("html"));(0,a.useEffect)((function(){r?t({type:"database",icon:(0,o.tZ)(Ve.Z,{}),tooltip:"Database"}):n("database")}),[r,t,n])}(),function(){var e=ht().repl,t=(0,l.b9)($e.ye),n=(0,l.b9)($e.jw),r=(null===e||void 0===e?void 0:e.isProject)||(null===e||void 0===e?void 0:e.isProjectFork);(0,a.useEffect)((function(){r?t({type:"autograder",icon:(0,o.tZ)(He.Z,{}),tooltip:"Tests",IconWrapper:pt}):n("autograder")}),[r,t,n])}(),function(){var e=ht().repl,t=(0,l.b9)($e.ye),n=(0,l.b9)($e.jw),r=!((null===e||void 0===e?void 0:e.isProject)||(null===e||void 0===e?void 0:e.isProjectFork));(0,a.useEffect)((function(){r?t({type:"unitTests",icon:(0,o.tZ)(He.Z,{}),tooltip:"Unit tests"}):n("unitTests")}),[r,t,n])}(),function(){var e,t,n=ht().repl,r=(0,l.b9)($e.ye),i=(0,l.b9)($e.jw),c=(null===n||void 0===n?void 0:n.isProjectFork)&&!(null===n||void 0===n?void 0:n.isModelSolution)&&"Team"===(null===n||void 0===n||null===(e=n.owner)||void 0===e?void 0:e.__typename)&&(null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.isAdmin);(0,a.useEffect)((function(){c?r({type:"education",icon:(0,o.tZ)(Ne.Z,{}),tooltip:"Teams for Education"}):i("education")}),[c,r,i])}(),function(){var e=(0,l.b9)($e.ye);(0,a.useEffect)((function(){e({type:"preferences",icon:(0,o.tZ)(Xe.Z,{}),tooltip:"Settings"})}),[e])}(),function(){var e=(0,c.useRouter)(),t=ht().currentUser,n=(0,l.b9)($e.ye),r=(0,l.b9)($e.jw),i=(null===t||void 0===t?void 0:t.isAdmin)||Boolean(e.query.debug)||mt;(0,a.useEffect)((function(){window.debug=function(){mt=!0,n({type:"adminPanel",icon:(0,o.tZ)(Ye.Z,{}),tooltip:"Debug"})}}),[n]),(0,a.useEffect)((function(){i?n({type:"adminPanel",icon:(0,o.tZ)(Ye.Z,{}),tooltip:"Debug"}):r("education")}),[i,n,r])}(),{items:e,activeItem:t,onDockItemClick:n}}var bt=n(73742),wt=n(45557);function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e){var t=e.item,n=e.isActive,r=e.onClick,i=xt(a.useState(!0),2),l=i[0],c=i[1],u=a.useRef(null),s=xt((0,Ue.XZ)(u,!1),4),d=s[0],f=s[1],p=s[2],v=s[3];(0,Ue.Ym)(f,u);var y=(0,o.tZ)(h.hU,{innerRef:u,role:"tab",tabIndex:d,tooltipPlacement:"right","aria-selected":n,size:40,alt:t.tooltip,css:[n?[h.l0.backgroundColor.accentPrimaryDimmest,h.l0.color.accentPrimaryStrongest]:h.l0.color.foregroundDimmest,{"&:hover":n?[h.l0.backgroundColor.accentPrimaryDimmest,h.l0.color.accentPrimaryStrongest]:h.l0.color.accentPrimaryStrongest}],onKeyDown:p,onClick:function(e){v(),c(!1),r(e)},children:t.icon},t.type);return t.IconWrapper?(0,o.tZ)(t.IconWrapper,{isVisible:l,onDismiss:function(){return c(!1)},children:y}):y}var Et={cmdOrCtrlKey:!0,altKey:!1,shiftKey:!1,key:","},St={cmdOrCtrlKey:!0,altKey:!1,shiftKey:!0,key:"G"};function kt(){var e=gt(),t=e.items,n=e.activeItem,r=e.onDockItemClick,i=(0,l.b9)($e.Wp),a=(0,v.QHX)().data,c=null===a||void 0===a?void 0:a.currentUser;(0,de.x)(Et,{run:function(){i("preferences")}}),(0,ce.Y)({match:se.pl,data:{type:"action",icon:(0,o.tZ)(Xe.Z,{}),label:"Settings",description:"Manage editor settings",keyboardShortcut:Et,run:function(){i("preferences")}}});var u=t.some((function(e){return"git"===e.type}));return(0,de.x)(St,{run:function(){i("git")},enabled:u}),(0,ce.Y)({match:se.pl,data:{icon:(0,o.tZ)(wt.Z,{}),label:"Version control",description:"Open version control sidebar",type:"action",keyboardShortcut:St,run:function(){i("git")}}},{enabled:u}),(0,o.BX)(h.Tg,{elevated:!0,css:[h.l0.borderRadius(4,0,0,4),h.l0.colWithGap(4),h.l0.flex.growAndShrink(1),h.l0.justify.spaceBetween,h.l0.align.center,h.l0.pb(8),h.l0.position.relative,{borderRight:"1px solid "+h.TV.backgroundHigher}],children:[(0,o.tZ)(Ue.uP,{options:{direction:"vertical"},children:(0,o.BX)(h.G7,{css:[h.l0.p(4),h.l0.overflowY("auto"),h.l0.flex.growAndShrink(1),h.l0.colWithGap(4),h.l0.align.start],role:"tablist","aria-orientation":"vertical","aria-label":"Dock",children:[t.map((function(e){var t=e.type===n;return(0,o.tZ)(h.G7,{children:(0,o.tZ)(It,{item:e,isActive:t,onClick:function(){return r(e.type)}})},e.type)})),0===t.length?(0,o.tZ)(h.hU,{"aria-disabled":!0,alt:"",size:40,css:{opacity:0},children:(0,o.tZ)(Fe.Z,{})}):null]})}),c?(0,o.tZ)(bt.Z,{css:[h.l0.center,h.l0.shadow(1),h.l0.cursor.pointer,h.l0.color.foregroundDimmer,h.l0.backgroundColor.backgroundDefault,{border:"1px solid ".concat(h.TV.backgroundHighest),userSelect:"none",transition:"0.1s",borderRadius:"100%"}],currentUser:c}):null,(0,o.tZ)(Ct,{direction:"top"}),(0,o.tZ)(Ct,{direction:"bottom"})]})}function Ct(e){return(0,o.tZ)(h.Tg,{css:[h.l0.position.absolute,h.l0.right(-5),h.l0.width(4),h.l0.height(4),"top"===e.direction?h.l0.top(0):h.l0.bottom(0),{pointerEvents:"none"}]})}var Pt=(0,a.memo)(kt),At=n(91898),Ot=n(56928),Dt=n(29868);function Rt(e){var t=e.children,n=a.useRef({fileMap:new Map});return(0,o.tZ)(At.Z.Provider,{value:n,children:t})}function jt(e){var t=e.ui,n=e.services,r=e.replId,i=e.children;return(0,o.tZ)(Re.kz,{value:t,children:(0,o.tZ)(Rt,{children:(0,o.tZ)(Ot.Z.Provider,{value:n,children:(0,o.tZ)(Dt.Z.Provider,{value:r,children:i})})})})}var Tt=n(70917),Mt=n(66552),Gt=n(54929),Ut=n(94074),_t=n(33605);function zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ft=(0,Gt.K)("div"),Bt=["n","s","e","w","ne","nw","se","sw"];function Nt(e){var t=e.resizable&&e.onResizeControlMouseDown?Bt.map((function(t){return(0,o.tZ)(Lt,{size:8,side:t,onMouseDown:function(n){if(!e.onResizeControlMouseDown)throw new Error("Expected onResizeControlMouseDown");e.onResizeControlMouseDown(n,t)}},t)})):null,n=e.rect,r=e.floating?2:void 0;(e.isBeingDragged||e.active)&&(r=(r||2)+1);var i=(0,Tt.iv)([rt.l0.position.absolute,rt.l0.width(n.width),rt.l0.height(n.height),e.hidden&&{visibility:"hidden"},{transform:"translate(".concat(Math.round(n.x),"px, ").concat(Math.round(n.y),"px)"),transition:e.animate?"transform 140ms, width 140ms, height 140ms":void 0,transitionTimingFunction:"ease-out",zIndex:r},!_t.g&&{"& .cm-editor > .cm-tooltip":{width:"fit-content",transform:"translate(".concat(-e.viewportInset.x,"px, ").concat(-e.viewportInset.y,"px)")},"& .cm-editor > .cm-tooltip.cm-tooltip-thread":{left:"0px !important",transform:"translateY(".concat(-e.viewportInset.y,"px)")},".cm-custom-context-menu":{transform:"translate(".concat(-e.viewportInset.x,"px, ").concat(-e.viewportInset.y,"px)")}}]),a=(0,Tt.iv)([{borderRadius:4}]),l=(0,Tt.iv)([{transform:"scale(".concat(e.scaleDown?.8:1,")"),transformOrigin:"center top"},e.animate&&{transition:"transform 140ms ease-out",transitionDelay:e.scaleDown?"100ms":"0ms"}]);return(0,o.tZ)(Gt.Z,{css:[i,(0,Ut.PH)({active:e.active})],children:(0,o.BX)(Mt.Z,{onClick:e.onClick,onContextMenu:e.onClick,elevated:!0,css:[rt.l0.coverContainer,a,l],className:e.className,children:[(0,o.tZ)(Gt.Z,{css:[rt.l0.coverContainer],children:e.children}),t]})})}function Lt(e){var t=e.side,n=e.size,r=e.onMouseDown;if("n"===t||"s"===t)return(0,o.tZ)(Ft,{onMouseDown:r,css:zt({cursor:"ns-resize",width:"calc(100% - ".concat(2*n,"px)"),height:n,position:"absolute",left:"50%",transform:"translate(-50%, ".concat("n"===t?2-n:n-2,"px)")},"n"===t?"top":"bottom",0)});if("e"===t||"w"===t)return(0,o.tZ)(Ft,{onMouseDown:r,css:zt({cursor:"ew-resize",height:"calc(100% - ".concat(2*n,"px)"),width:n,position:"absolute",top:"50%",transform:"translate(".concat("e"===t?n-2:2-n,"px, -50%)")},"e"===t?"right":"left",0)});var i,a="nw"===t||"se"===t?"nwse-resize":"nesw-resize";return(0,o.tZ)(Ft,{onMouseDown:r,css:(i={cursor:a,height:n,width:n,position:"absolute"},zt(i,t.includes("n")?"top":"bottom",0),zt(i,t.includes("e")?"right":"left",0),i)})}var Kt=n(83964),Wt=n(3943),Vt=(0,l.cn)(null),Xt=(0,l.cn)(null,(function(e,t,n){var r=e(Q.g4);if("end"===n.type)return t(Vt,null),t(Q.YF,r),void t(Wt.Mb);if("update"!==n.type){var i=e(Q.Eh).find((function(e){return e.paneId===n.paneId}));if(!i)throw new Error("Expected pane");t(Q.W1,{paneId:n.paneId}),t(Vt,{paneId:n.paneId,side:n.side,rectStart:i.rect})}else{var o=e(Vt);if(!o)throw new Error("Expected floatingResizeState");var a=(0,Kt.XR)(o.rectStart,{delta:n.moveDelta,side:o.side}),l=o.paneId,c=(0,q.ZP)(r,(function(e){var t=e.floating.find((function(e){return e.panes.includes(l)}));if(!t)throw new Error("Expected floating");var n=t.rect;n.x=a.x,n.y=a.y,n.width=a.width,n.height=a.height}));t(Q.YF,c)}})),Ht=n(27291),qt=n(97285);function Yt(){var e=(0,Ht.Z)((0,l.Dv)(qt.$));return(0,a.useCallback)((function(){setTimeout((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.focus()}),0)}),[e])}var $t=n(75661),Qt=n(66168);function Jt(e){return(0,o.tZ)(Gt.Z,{css:[rt.l0.width("100%"),rt.l0.flex.growAndShrink(1),{overflow:"auto"},e.disableInteractions&&{pointerEvents:"none",userSelect:"none"}],children:e.children})}var en=n(90039),tn=n(19537),nn=n(28771);function rn(e){var t=e.paneIds,n=e.activeIndex,r=e.onClick;return(0,o.tZ)(Ue.uP,{options:{direction:"horizontal"},children:(0,o.tZ)(h.Tg,{"ari-label":"Panes",role:"tablist","aria-orientation":"vertical",background:"root",css:[h.l0.height(32),h.l0.flex.row,h.l0.align.end,h.l0.position.relative],children:t.map((function(e,t){return(0,o.tZ)(nn.q,{paneId:e,isActive:n===t,onClick:function(){r(t)}},e)}))})})}var on=n(11717);function an(e){return!function(e){return $e.Dn.includes(e)}(e)&&!["webview","vnc","config"].includes(e)}var ln=(0,l.cn)(null),cn=(0,l.cn)(null,(function(e,t,n){if("end"!==n.type)if("update"!==n.type){var r=e(Q.g4),i=n.stacked?window.innerHeight:window.innerWidth,o=(0,lt.K)(r,n.leftPath);if(!o||!(0,ct.r)(o))throw new Error("Expected left node");var a=(0,ct.I)(n.leftPath),l=o.percent,c=function(e,t){var n=t.splitPath,r=(0,lt.K)(e,n);if(!r||"split"!==r.type)throw new Error("Expected split node");for(var i=100,o=(0,ct.I)(n);o.length;){var a=(0,lt.K)(e,o);if(!a)break;o=(0,ct.I)(o),"split"===a.type&&a.stacked===r.stacked&&(i*=a.percent/100)}return i}(r,{splitPath:a}),u=e(Q.CK),s=Q.pc/i*100,d=(0,lt.K)(r,a);if("split"!==(null===d||void 0===d?void 0:d.type))throw new Error("Expected parent split node");var f=d.children.length,p=e(Q.M0),v=n.stacked?Q.SG*(f-1)+p*f:Q.SG*(f-1),h=((n.stacked?u.height:u.width)-v)*(c/100);t(ln,{stacked:n.stacked,leftPath:n.leftPath,startPercent:l,resizeDistance:h,snapPercent:s,initialLayout:r})}else{var y=e(ln);if(!y)throw new Error("Expected tilingResize");var m=y.stacked,g=y.leftPath,b=y.startPercent,w=y.resizeDistance,Z=y.initialLayout,x=y.snapPercent,I=b+(m?n.moveDelta.y:n.moveDelta.x)/w*100,E=(0,q.ZP)(Z,(function(e){ut(e,{leftPath:g,percent:I,snapPercent:x})}));t(Q.YF,E)}else t(ln,null)})),un=(0,l.cn)((function(e){return null!==e(Vt)||null!==e(ln)})),sn=n(25108);function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pn(e){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vn(e,t){return!t||"object"!==mn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hn(e,t){return(hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var mn=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function gn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pn(e);if(t){var i=pn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vn(this,n)}}var bn=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hn(e,t)}(n,e);var t=gn(n);function n(){var e;return fn(this,n),(e=t.apply(this,arguments)).state={error:null,errorInfo:null},e}var r=n.prototype;return r.componentDidCatch=function(e,t){this.setState({error:e,errorInfo:t}),this.props.handleError(e,t),sn.error(e)},r.render=function(){return this.state.error?(0,o.tZ)(h.G7,{css:[h.l0.font.code,h.l0.p(16),{whiteSpace:"pre",overflow:"hidden",color:"white"},h.l0.backgroundColor.blurpleDefault,h.l0.height("100%")],children:(0,o.tZ)(h.G7,{children:this.state.error.stack})}):this.props.children},n}(a.Component);function wn(e){var t=e.paneId,n=(0,l.Dv)(Q.CK),r=(0,l.Dv)(un),i=(0,l.Dv)((0,Q.z)(t)),a=(0,l.Dv)(i.data),c=(0,l.Dv)(i.isMaximizedAtom),u=(0,l.Dv)(Q.uc),s=(0,l.Dv)(i.isActiveAtom),d=(0,l.Dv)(i.isHighlightedAtom),f=yn((0,l.KO)(Q.tt),2),p=(f[0],f[1]),v=(0,l.b9)(Xt),h=(0,l.b9)(Q.W1),y="floating"===i.type&&!i.isDialog,m=Boolean(i.dropBehavior),g=m||c,b=(0,Qt.Zh)(a.type),w=(0,Qt.oq)(a.type),Z=(0,on.VV)(),x=!an(a.type),I=(0,l.Dv)(Q.M0),E=c?u:{x:i.rect.x,y:i.rect.y-(x?I:0),width:i.rect.width,height:i.rect.height+(x?I:0)},S={x:n.x+E.x,y:n.y+E.y},k=(0,en.Z)(),C=Yt();return(0,o.BX)(o.HY,{children:[i.isDialog?(0,o.tZ)(En,{}):null,(0,o.tZ)(Nt,{hidden:i.isHidden,css:[!Z&&b&&k&&{boxShadow:"0 0 0 3px ".concat(k)}],viewportInset:S,active:s,highlight:d,rect:E,animate:!1,isBeingDragged:m,floating:g,scaleDown:"tile"===i.dropBehavior,resizable:y,onClick:function(){h({paneId:t})},onResizeControlMouseDown:function(e,n){(0,$t.g)(e,{start:function(){v({type:"start",paneId:t,side:n})},move:function(e){var t=e.delta;v({type:"update",moveDelta:t})},end:function(){v({type:"end"})}})},children:(0,o.BX)(bn,{handleError:function(e,t){var n=(0,je.Z)(e,{extras:{errInfo:t},tags:{layoutv2:"true",bsod:"true",paneType:i.type}});p(n)},children:[!b||i.isHidden||Z?null:(0,o.tZ)(tn.Z,{style:{height:32,minHeight:32,overflowX:"hidden"},focusCodeEditor:C}),w&&!Z?(0,o.tZ)(Zn,{paneId:t}):null,(0,o.tZ)(Jt,{disableInteractions:r,children:(0,o.tZ)(In,{paneId:t,dataAtom:i.data,isHidden:i.isHidden})})]},t)})]})}function Zn(e){var t=e.paneId,n=(0,l.Dv)(Q.g4),r=(0,lt.R)(n,t),i=(0,l.b9)(Te.Oe),a=r.paneGroup,c=a.panes,u=a.activeIndex;return 1===c.length?null:(0,o.tZ)(rn,{paneIds:c,activeIndex:u,onClick:function(e){var t=c[e];i(t)}})}function xn(e){var t=e.paneId,n=e.isHidden,r=e.dataAtom,i=(0,l.Dv)(r),a=(0,Re.Se)().Content,c=(0,l.b9)(J.zx);return(0,o.tZ)(a,{pane:i,options:{paneId:t,isHidden:n,openPane:function(e){c({fromPaneId:t,data:e})}}})}var In=(0,a.memo)(xn);function En(){var e=(0,l.b9)(ie);return(0,o.tZ)(h.G7,{onClick:function(){return e()},css:[h.l0.coverContainer,h.l0.position.fixed,h.l0.backgroundColor.backgroundOverlay]})}var Sn=(0,a.memo)(wn);function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cn(e,t,n){var r=!!/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)?32:0;if(n){var i=2/3,o=Math.max(e.width,r*i),a=Math.max(e.height,r*i),l="left"===n?1:-1,c=t?0:l*(o-e.width)/2,u=t?l*(a-e.height)/2:0;return{width:t?e.width:o,height:t?a:e.height,x:t?e.x:e.x-(o-e.width)/2+c,y:t?e.y-(a-e.height)/2+u:e.y}}var s=Math.max(e.width,r),d=Math.max(e.height,r);return{width:t?e.width:s,height:t?d:e.height,x:t?e.x:e.x-(s-e.width)/2,y:t?e.y-(d-e.height)/2:e.y}}var Pn="--grip-color",An="var(".concat(Pn,")");function On(e){var t,n=e.rect,r=e.onMouseDown,i=e.onDoubleClick,a=e.stacked,l=e.snapped,c=Cn(n,a,l);return(0,o.tZ)(Gt.Z,{className:"tiling-handle",onMouseDown:r,onTouchStart:r,onDoubleClick:i,onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},css:[rt.l0.width(c.width),rt.l0.height(c.height),rt.l0.position.absolute,rt.l0.center,{zIndex:1},(t={transform:"translate(".concat(c.x,"px, ").concat(c.y,"px)"),borderRadius:rt.TV.borderRadius8,minWidth:8,minHeight:8,cursor:a?"row-resize":"col-resize"},kn(t,Pn,rt.TV.outlineDimmest),kn(t,":active .grip-line, :hover .grip-line",kn({},Pn,rt.TV.foregroundDefault)),t)],children:(0,o.tZ)(Gt.Z,{className:"grip-line",css:[{transitionDuration:"140ms"},"left"===l&&{transform:a?"translate(0px, -2px) rotate(135deg)":"translate(-2px, 0px) rotate(45deg)"},"right"===l&&{transform:a?"translate(0px, 2px) rotate(-45deg)":"translate(2px, 0px) rotate(-135deg)"},l&&[rt.l0.width(6),rt.l0.height(6),{borderRight:"1px solid",borderTop:"1px solid",borderColor:An,transition:"border-color"}],!l&&[{width:a?25:2,height:a?2:25,backgroundColor:An,transition:"background-color"},rt.l0.borderRadius(4)]]})})}function Dn(e){var t=e.handleId,n=(0,l.Dv)((0,Q.vv)(t)),r=(0,l.b9)(cn),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=(0,a.useRef)(e),n=(0,l.b9)(dt),r=(0,st.lV)((0,a.useCallback)((function(e){return e(Q.g4)}),[]));return(0,a.useCallback)((function(i){i.snapped?n({leftPath:i.leftPath,percent:t.current}):Promise.resolve(r()).then((function(r){var o=(0,lt.K)(r,i.leftPath);if(!o||!(0,ct.r)(o))throw new Error("Expected split or paneGroup");t.current=o.percent,n({leftPath:i.leftPath,percent:e})}))}),[e,n,r])}();return(0,o.tZ)(On,{snapped:n.snapped,rect:n.rect,stacked:n.stacked,onDoubleClick:function(){i(n)},onMouseDown:function(e){(0,$t.g)(e,{start:function(){r({type:"start",leftPath:n.leftPath,stacked:n.stacked})},move:function(e){var t=e.delta;r({type:"update",moveDelta:t})},end:function(){r({type:"end"})}})}})}var Rn=(0,a.memo)(Dn),jn=n(62991),Tn=n.n(jn),Mn=n(43421),Gn=n(51739),Un=n(56718),_n=n(46846),zn=n(24521),Fn=n(94590),Bn=n(59367),Nn=n(45536),Ln=n(67289),Kn=n(95722),Wn=n(39550),Vn=n(81736),Xn=n(23589),Hn=n(74868),qn=n(21563),Yn=n(11938),$n=n(97600),Qn=n(21843),Jn=n(31412);function er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||rr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e){return function(e){if(Array.isArray(e))return er(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||rr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(e,t){if(e){if("string"===typeof e)return er(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?er(e,t):void 0}}function ir(e){var t=e.paneId,n=e.isActive,r=e.onClick,i=e.onClose,c=(0,l.Dv)((0,Q.z)(t)),u=(0,l.Dv)(c.data),s=(0,Re.Se)().getTitle(u),d=(0,a.useRef)(null),f=tr((0,Mn.c)({type:Un.z.Pane,item:function(){var e,n=(null===(e=d.current)||void 0===e?void 0:e.getBoundingClientRect().width)||80;return{type:Un.z.Pane,paneId:t,width:n}},collect:function(e){return{isDragging:e.isDragging()}}}),2),p=f[0].isDragging,v=f[1],y=(0,l.b9)(Te.c);return(0,a.useEffect)((function(){return y(p)}),[y,p]),(0,o.tZ)(h.G7,{css:p?[h.l0.width(0),h.l0.visibility.hidden]:[h.l0.px(2)],children:(0,Qt.KM)(u)?(0,o.tZ)(zn.gn,{innerRef:(0,Hn.l)(v,d),filePath:s,isActive:n,onClick:r,onClose:i}):(0,o.tZ)(zn.$k,{innerRef:(0,Hn.l)(v,d),title:s,isActive:n,onClick:r,onClose:i})})}function or(e){var t=e.headerId,n=e.activeFile,r=e.activePaneId,i=(0,H.Z)(),a=(0,v.G7f)({variables:{replId:i}}).data,c="Repl"===(null===a||void 0===a?void 0:a.repl.__typename)?a.repl.language:"",u=(0,l.Dv)(Te.bg),s=(0,l.b9)(Te.ao),d=(0,l.b9)(Te.Ky),f=n&&(0,Ln.gK)(n),p=function(e){var t=e.headerId,n=(0,Wn.Z)(),r=(0,l.Dv)((0,Q.Xs)(t)),i=(0,l.Dv)(Qn.gr);return n&&Tn()(r.path,i)?n:null}({headerId:t}),y=function(e){var t=e.activePaneId,n=(0,Jn.Z)(),r=(0,l.Dv)((0,Q.z)(t));return(0,l.Dv)(r.isActiveAtom)&&n.length>0?n:null}({activePaneId:r}),m=Yt(),g=null;return p?g=(0,o.tZ)($n.Z,{id:p.id,username:p.username,color:p.color}):f&&n?g=u?(0,o.tZ)(h.zx,{css:{backgroundColor:"transparent"},iconLeft:(0,o.tZ)(Vn.Z,{}),text:"Close preview",onClick:function(){s({type:"markdown"}),m()}}):(0,o.tZ)(h.zx,{css:{backgroundColor:"transparent"},iconLeft:(0,o.tZ)(Xn.Z,{}),text:"Open preview",onClick:function(){n&&(d({type:"markdown",data:{path:n}}),m())}}):n&&(g=(0,o.tZ)(Kn.Z,{filePath:n,replLanguage:c})),null!==g||y?(0,o.BX)(h.G7,{css:[h.l0.px(4),h.l0.rowWithGap(8)],children:[y&&n?(0,o.tZ)(qn.Z,{}):null,g]}):null}function ar(e){var t=e.headerId,n=(0,l.Dv)((0,Q.Xs)(t)),r=n.rect,i=(0,l.b9)(Te.Oe),c=(0,l.b9)(Te.Et),u=(0,l.b9)(Te.SG),s=(0,l.b9)(J.$r),d=(0,l.b9)(J.vN),f=(0,Nn.Z)(),p=(0,l.Dv)(Te.c),v=(0,l.Dv)((0,Q.z)(n.panes[n.activeIndex])),y=(0,l.Dv)(v.data),m=null;(0,Qt.KM)(y)&&(m="dotReplitEditor"===y.type?Yn.l:y.data.path);var g=tr((0,Gn.L)({accept:[_n.Tv.File,Un.z.Pane],hover:function(e,t){var r=t.getSourceClientOffset();r&&I({item:e,panes:n.panes,sourceClientOffset:r.x})},collect:function(e){return{isOver:e.isOver()}},drop:function(e,t){if(!t.didDrop()){var r=null!==(null===E||void 0===E?void 0:E.index)?null===E||void 0===E?void 0:E.index:n.panes.length;if(e.type!==_n.Tv.File){var i=n.panes.includes(e.paneId)?n.panes.length-1:n.panes.length;u({paneId:e.paneId,index:void 0!==r&&r<i?r:i,toPaneGroupPath:n.path})}else c({paneGroupPath:n.path,index:r,pane:{type:"codeEditor",data:{path:e.path}}})}}}),2),b=g[0],w=g[1],Z=function(e){var t=e.isOver,n=(0,a.useState)(null),r=n[0],i=n[1],o=(0,a.useRef)(null),l=(0,a.useRef)([]);(0,a.useEffect)((function(){if(!t)return l.current=[],void i(null);o.current&&(l.current=nr(o.current.children).map((function(e){var t=e.getBoundingClientRect();return t.x+t.width/2})))}),[t]);var c=(0,a.useCallback)((function(e){if(0!==l.current.length){var t=e.item.type===Un.z.Pane?e.item:null,n=(null===t||void 0===t?void 0:t.paneId)||null,r=n?e.panes.indexOf(n):-1,o=(null===t||void 0===t?void 0:t.width)||80,a=l.current.map((function(e,t){return-1===r||r<t?e:e+o/2})).findIndex((function(t){return t>e.sourceClientOffset})),c=-1===a,u=-1===r?e.panes.length:e.panes.length-1;i({index:c?u:Math.min(a,u),paneId:n,width:o})}}),[]);return{tabContainerRef:o,hover:c,dropState:r}}({isOver:b.isOver}),x=Z.tabContainerRef,I=Z.hover,E=Z.dropState,S=E?E.index:null;if((null===E||void 0===E?void 0:E.paneId)&&null!==S){var k=n.panes.indexOf(E.paneId);k>-1&&k<S&&S++}var C=E&&null!==S?nr(n.panes.slice(0,S)).concat([E],nr(n.panes.slice(S))):n.panes;return an(y.type)?(0,o.BX)(h.Tg,{elevated:!0,css:[h.l0.borderRadius(8,8,0,0),h.l0.position.absolute,h.l0.width(r.width),h.l0.height(r.height),h.l0.flex.row,h.l0.align.center,{transform:"translate(".concat(r.x,"px, ").concat(r.y,"px)")}],children:[(0,o.BX)(h.G7,{css:[h.l0.rowWithGap(2),h.l0.flex.growAndShrink(1),h.l0.align.center,h.l0.height("100%")],innerRef:w,children:[(0,o.tZ)(h.G7,{css:[h.l0.flex.row,h.l0.flex.shrink(1),h.l0.align.center,h.l0.height("100%")],children:(0,o.tZ)(Bn.E,{style:{height:"100%",width:"100%"},className:f.className,options:{overflowBehavior:{y:"hidden"},scrollbars:{autoHide:"leave",visibility:p?"hidden":"auto"}},onWheel:f.handleWheel,ref:f.ref,children:(0,o.tZ)(h.G7,{innerRef:x,css:[h.l0.flex.row,h.l0.height("100%"),h.l0.py(4),h.l0.px(8)],children:C.map((function(e,t){var r=n.activeIndex===t;return"string"!==typeof e?(0,o.tZ)(h.G7,{css:[h.l0.px(2)],children:(0,o.tZ)(h.G7,{css:[h.l0.borderRadius(8),h.l0.width(e.width),h.l0.height(28),h.l0.backgroundColor.accentPrimaryDimmest,{border:"1px dashed ".concat(h.TV.accentPrimaryDefault)}]})},"preview"):(0,o.tZ)(ir,{paneId:e,isActive:r,onClick:function(){i(e)},onClose:function(){1!==n.panes.length?s(e):d({paneId:e,data:{type:"commands",data:{autoFocus:!1}}})}},e)}))})})}),(0,o.tZ)(h.hU,{alt:"New tab",tooltipHidden:!0,onClick:function(){c({paneGroupPath:n.path,pane:{type:"commands",data:{autoFocus:!0}}})},children:(0,o.tZ)(Fn.Z,{})})]}),(0,o.tZ)(or,{headerId:t,activePaneId:v.paneId,activeFile:m})]}):null}var lr=(0,a.memo)(ar),cr=n(5031);function ur(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sr=(0,l.cn)(null),dr=((0,l.cn)(null,(function(e,t,n){switch(n.type){case"start":t(dr,n);break;case"update":t(fr,n);break;case"end":t(pr,n)}})),(0,l.cn)(null,(function(e,t,n){var r=e(Q.Eh).find((function(e){return e.paneId===n.paneId}));if(!r)throw new Error("Expected pane");var i="tile"===r.type&&n.shiftKey||"floating"===r.type&&!n.shiftKey;t(Q.W1,{paneId:n.paneId}),t(sr,{fromRect:r.rect,toRect:r.rect,dropBehavior:i?"float":"tile",paneId:r.paneId,active:!1})}))),fr=(0,l.cn)(null,(function(e,t,n){var r=e(Q.CK),i=e(Q.g4),o=e(Q.Eh),a=o.find((function(e){return e.paneId===n.paneId}));if(!a)throw new Error("Expected pane");var l=e(sr);if(l){var c=l.fromRect,u=l.toRect,s=.05*c.width,d=.05*c.height,f=n.shiftKey,p=Math.abs(u.x-c.x)>s||Math.abs(u.y-c.y)>d,v=null,h=(0,Q.z)(a.paneId);if(p&&"tile"===l.dropBehavior){var y={x:n.mouse.x-r.x,y:n.mouse.y-r.y},m=!0,g=!1,b=void 0;try{for(var w,Z=o[Symbol.iterator]();!(m=(w=Z.next()).done);m=!0){var x=w.value;if("tile"===x.type&&x.paneId!==l.paneId){var I=x.paneId===a.paneId?l.fromRect:x.rect;if((0,Kt.V0)(y,I)){var E=e((0,Q.z)(x.paneId));if("commands"===e(E.data).type&&x.paneId!==a.paneId){v={rect:x.rect,placement:"replace",over:x.paneId};break}var S=(0,Kt.QN)(y,I);if(S){v={rect:S.rect,placement:S.placement,over:x.paneId};break}}}}}catch(P){g=!0,b=P}finally{try{m||null==Z.return||Z.return()}finally{if(g)throw b}}var k={x:0,y:0,width:r.width,height:r.height};null===i.tiling&&(0,Kt.V0)(y,k)&&(v={rect:k,over:null,placement:"replace"})}var C={x:c.x+n.delta.x,y:c.y+n.delta.y,width:c.width,height:c.height};t(h,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ur(e,t,n[t])}))}return e}({},e,{rect:C,isBeingDragged:!0,isDialog:!1,dropBehavior:f?"float":"tile"})})),t(sr,{fromRect:l.fromRect,toRect:C,dropBehavior:f?"float":"tile",paneId:a.paneId,dropPreview:v,active:!0})}})),pr=(0,l.cn)(null,(function(e,t,n){var r=function(e){return Math.max(-8,e)},i=e(Q.Eh).find((function(e){return e.paneId===n.paneId}));if(!i)throw new Error("Expected pane");var o=e(Q.g4),a=e(sr);if(a){var l=a.dropBehavior,c=a.dropPreview,u=(0,q.ZP)(o,(function(e){if("tile"===l&&"tile"===i.type&&(null===c||void 0===c?void 0:c.over)){var t=a.paneId,n=c.placement,o=c.over;if(t===o)return;!function(e,t){var n=t.from,r=t.to,i=t.placement;(0,cr.i)(e,n),(0,ee.mZ)(e,{relativeTo:r,panes:[n],placement:i})}(e,{from:t,to:o,placement:n})}else if("float"!==l||"floating"!==i.type)if("float"!==l||"tile"!==i.type){if(c&&"tile"===l&&"floating"===i.type)return null===e.tiling?void(e.tiling={panes:[i.paneId],type:"paneGroup",percent:100,activeIndex:0}):void function(e,t){var n=t.paneId,r=t.placement,i=t.to;(0,cr.i)(e,n),null!==i?(0,ee.mZ)(e,{relativeTo:i,panes:[n],placement:r}):e.tiling={panes:[n],percent:100,type:"paneGroup",activeIndex:0}}(e,{paneId:i.paneId,placement:c.placement,to:c.over})}else{var u=a.toRect;!function(e,t){var n=t.paneId,r=t.rect;(0,cr.i)(e,n),(0,ee.mZ)(e,{isFloating:!0,panes:[n],rect:r,activeIndex:0})}(e,{paneId:a.paneId,rect:{x:u.x,y:r(u.y),width:u.width,height:u.height}})}else{var s=e.floating.find((function(e){return e.panes.includes(i.paneId)}));if(!s)throw new Error("Expected floating");var d=a.toRect;s.rect={x:d.x,y:r(d.y),width:d.width,height:d.height}}}));t(sr,null),t(Q.YF,u),t(Wt.Mb)}})),vr=(0,l.cn)((function(e){var t;return null===(t=e(sr))||void 0===t?void 0:t.dropPreview}));function hr(e){var t=e.rect,n=e.animate,r=e.borderRadius,i=void 0===r?8:r;return(0,o.tZ)("div",{css:[rt.l0.position.absolute,rt.l0.width(t.width),rt.l0.height(t.height),rt.l0.backgroundColor.accentPrimaryDefault,{borderRadius:i,pointerEvents:"none",zIndex:1,opacity:.2,transform:"translate(".concat(Math.round(t.x),"px, ").concat(Math.round(t.y),"px)")},n&&{transition:"transform 140ms, width 140ms, height 140ms"}]})}function yr(){var e=(0,l.Dv)(vr),t=(0,l.Dv)(Q._E);return e?(0,o.tZ)(hr,{rect:e.rect,animate:t}):null}var mr=(0,a.memo)(yr),gr=n(85252);var br=n(82221),wr=n(90768),Zr=n(90002);function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ir(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function Er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return xr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sr(e){var t=Er(a.useState(!1),2),n=t[0],r=t[1],o=(0,Zr.X)(),l=o&&!o.isDone&&!o.isLoading;a.useEffect((function(){l||e&&"default"===(0,wr.eo)()&&r(!0)}),[e,l]);var c,u=a.useCallback((function(){(0,wr.Oc)(!0),r(!1)}),[]),s=a.useCallback((c=i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,wr.$q)();case 2:r(!1);case 3:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(n,r){var i=c.apply(e,t);function o(e){Ir(i,n,r,o,a,"next",e)}function a(e){Ir(i,n,r,o,a,"throw",e)}o(void 0)}))}),[]);return{shouldShowModal:n,hideModal:u,confirm:s}}var kr=n(5881),Cr=n(10586),Pr=n(71054),Ar=n(49265),Or=n(16108),Dr=n(6407),Rr=n(21217),jr=n(849),Tr=n(29738),Mr={cmdOrCtrlKey:!0,altKey:!1,shiftKey:!1,key:"Enter"};function Gr(){var e=(0,l.b9)(le.cN),t=(0,a.useState)(!1),n=t[0],r=t[1],i=(0,Tr.A)(),c=(0,E.Z)(),u=c.fs,s=c.session,d=c.container,f=c.runner,p=(0,F.L)(f);return(0,de.x)(Cr.q,{run:e}),(0,de.x)(Pr.q,{run:function(){e(Pr.i({fs:u,session:s,getRecentFiles:i}))}}),(0,de.x)(Ar.q,{run:function(){e(Ar.F({container:d}))}}),(0,ce.Y)(Pr.i({session:s,fs:u,getRecentFiles:i})),(0,ce.Y)(Ar.F({container:d})),(0,ce.Y)({match:se.pl,data:{type:"action",icon:(0,o.tZ)(Or.Z,{}),label:"Run",description:"Run Repl",run:function(){f.run()},keyboardShortcut:Mr}},{enabled:p===Rr.A.IDLE}),(0,de.x)(Mr,{run:function(){p===Rr.A.RUNNING&&f.stopRun(),f.run()},enabled:p!==Rr.A.OFFLINE}),(0,ce.Y)({match:se.pl,data:{type:"action",icon:(0,o.tZ)(Dr.Z,{}),label:"Stop",description:"Stop Repl",run:function(){f.stopRun()}}},{enabled:p===Rr.A.RUNNING}),(0,ce.Y)({match:(0,se.zf)({defaultScore:.5}),data:{type:"action",label:"Create",icon:(0,o.tZ)(Fn.Z,{}),description:"Create a new Repl",run:function(){r(!0)}}}),(0,o.tZ)(K.Z,{isOpen:n,onRequestClose:function(){return r(!1)},maxWidth:600,centered:!0,children:(0,o.tZ)(jr.Z,{})})}var Ur=(0,a.memo)(Gr),_r=n(93577),zr=n(67938),Fr=n(92704),Br=n(41045);function Nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lr(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function Kr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wr(){var e=(0,E.Z)().fs,t=(0,a.useRef)(new Map),n=(0,_r.Z)(),r=(0,a.useState)(!1),c=r[0],u=r[1],s=(0,a.useState)(!1),d=s[0],f=s[1],p=(0,a.useRef)(new Map),v=(0,l.b9)(Q.tt),y=(0,l.b9)(Te.a4);(0,a.useEffect)((function(){if(n&&!t.current.has(n)&&n!==Br.rq){var r=function(e){y(e),t.current.delete(n),p.current.delete(n)};(0,Ln.Mb)(n)?e.watchOtFile(n,{onMoveOrDelete:r,onError:function(t,n){if(!t.code){var r=(0,je.Z)(t,{extras:n,tags:{ot:!0}});e.flush(),e.persist({skipDebounce:!0}),v(r)}},onReconnectFail:function(e){p.current.set(n,e),u(!0)}}):e.watchFile(n,{onChange:function(){},onMoveOrDelete:r}),t.current.set(n,!0)}}),[n,e,v,y]);var m=function(){var e,t=(e=i().mark((function e(t){var n,r,o,a,l,c,s,d,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,b.j)(b.U3.FILE_RECONNECT_FALLBACK_CHOSEN,{choice:t}),(0,b.j)(b.U3.CONTENTS_DIVERGED_ACTION,{action:"local"===t?"client":"server"}),f(!0),e.next=5,new Promise((function(e){return setTimeout(e,1e3)}));case 5:if(!p.current.size){e.next=28;break}for(n=[],r=!0,o=!1,a=void 0,e.prev=8,l=p.current.entries()[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)s=Kr(c.value,2),d=s[0],v=s[1],n.push(v(t)),p.current.delete(d);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,a=e.t0;case 16:e.prev=16,e.prev=17,r||null==l.return||l.return();case 19:if(e.prev=19,!o){e.next=22;break}throw a;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,Promise.all(n);case 26:e.next=5;break;case 28:f(!1),u(!1);case 30:case"end":return e.stop()}}),e,null,[[8,12,16,24],[17,,19,23]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Lr(o,r,i,a,l,"next",e)}function l(e){Lr(o,r,i,a,l,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,o.tZ)(h.u_,{preventClose:!0,isOpen:c,onRequestClose:function(){},children:(0,o.BX)(h.G7,{css:[h.l0.colWithGap(24)],children:[(0,o.tZ)(zr.h,{level:3,variant:"headerDefault",children:"Contents diverged"}),(0,o.BX)(h.G7,{css:[h.l0.colWithGap(8)],children:[(0,o.tZ)(zr.x,{multiline:!0,children:"We had a hard time resolving differences between your content and server content while you were disconnected."}),(0,o.tZ)(zr.x,{children:"What would you like to do?"})]}),d?(0,o.tZ)(pe.Loader,{}):(0,o.tZ)(o.HY,{children:(0,o.BX)(h.G7,{css:[h.l0.rowWithGap(12),h.l0.justify.end],children:[(0,o.tZ)(Fr.zx,{onClick:function(){m("remote")},colorway:"negative",text:"Choose server changes"}),(0,o.tZ)(Fr.zx,{onClick:function(){m("local")},colorway:"positive",text:"Choose my changes"})]})})]})})}var Vr=n(52242);var Xr=n(20578),Hr=n(33379),qr=n(18614),Yr=n(89319),$r=n(89431);function Qr(){var e=(0,l.Dv)(Hr.c),t=(0,$r.Z)("flag-threads-2");return(0,$r.Z)("flag-old-layout-threads-inbox")?t?(0,o.BX)("div",{style:{position:"fixed",bottom:46,right:"var(--space-12)",zIndex:10},children:[(0,o.tZ)("div",{children:(0,o.tZ)(Xr.Z,{})}),e&&(0,o.tZ)("div",{style:{position:"relative"},children:(0,o.tZ)(Yr.Z,{})})]}):(0,o.tZ)("div",{style:{position:"fixed",bottom:"var(--space-24)",right:"var(--space-8)",zIndex:10},children:e?(0,o.BX)("div",{style:{position:"relative",right:"var(--space-8)"},children:[(0,o.tZ)("div",{children:(0,o.tZ)(Xr.Z,{})}),(0,o.tZ)("div",{style:{position:"relative"},children:(0,o.tZ)(qr.Z,{})})]}):(0,o.tZ)("div",{children:(0,o.tZ)(Xr.Z,{})})}):null}var Jr=n(3846),ei=n(36793),ti=(0,l.cn)(null,(function(e,t,n){var r,i=e(Q.g4),o=e($e.T5);if("split"!==(null===(r=i.tiling)||void 0===r?void 0:r.type))throw new Error("Expected split");var a=i.tiling.children.length===(o?2:1);if((!n||!a)&&(!(i.tiling.children.length===(o?3:2))||n)){var l=a?["tiling",o?1:0,0]:["tiling",o?1:0],c=a?["tiling",o?1:0,1]:["tiling",o?2:1],u=(0,q.ZP)(i,(function(e){var t=(0,lt.K)(e,l);if("paneGroup"!==(null===t||void 0===t?void 0:t.type))throw new Error("Expected editorNode");var r=(0,lt.K)(e,c);if(!r||!(0,ct.r)(r))throw new Error("Expected secondaryNode");"split"===r.type&&(r.stacked=!n);var i=o?(0,lt.R)(e,o.paneId):null;if(i&&i.floating)throw new Error("Expected tiled sidebarPaneNode");var a=null===i||void 0===i?void 0:i.paneGroup.percent;(0,cr.Z)(e,l),n?(0,ee.mZ)(e,{panes:t.panes,percent:t.percent,activeIndex:t.activeIndex,relativeTo:["tiling",o?1:0],placement:"above"}):(0,ee.mZ)(e,{panes:t.panes,percent:t.percent,activeIndex:t.activeIndex,relativeTo:["tiling",o?1:0],placement:"leftOf"}),i&&void 0!==a&&ut(e,{leftPath:["tiling",0],percent:a})}));t(Q.YF,u),t(Wt.Mb)}})),ni=n(85060),ri=n(56603),ii=n(81544),oi=!1;var ai=n(55877),li=n.n(ai);var ci={filetree:!0,codeEditor:!0,database:!0,webview:!0,media:!0,vnc:!0,pedit:!0,education:!0,runnerOutput:!0,unitTests:!0,autograder:!0,markdown:!0,shell:!0,packager:!0,envEditor:!0,commands:!0,draw:!0,preferences:!0,adminPanel:!0,git:!0,kaboombar:!0,instructions:!0,debugger:!0,tutorial:!0,config:!0,threadInbox:!0,dotReplitEditor:!0,extension:!0,docs:!0};function ui(e){if("number"!==typeof e)throw new Error("Expected number")}function si(e){if("string"!==typeof e)throw new Error("Expected string")}function di(e){if(si(e.type),ui(e.percent),"paneGroup"!==e.type){if("split"===e.type)return function(e){if("boolean"!==typeof e)throw new Error("Expected boolean")}(e.stacked),function(e){if(!Array.isArray(e.children))throw new Error("Expected children")}(e),void e.children.forEach(di);throw new Error("Invalid pane type: "+e.type)}if(!Array.isArray(e.panes))throw new Error("Expected panes array");e.panes.map(si)}function fi(e,t){if(!Array.isArray(e.floating))throw new Error("Expected floating");e.floating.forEach((function(e){if(!Array.isArray(e.panes))throw new Error("Expected panes array");!function(e){[e.x,e.y,e.width,e.height].forEach(ui)}(e.rect),e.panes.forEach((function(e){if(si(e),!t.includes(e))throw new Error("Unrecognized id")}))})),e.tiling&&di(e.tiling)}function pi(e){if("object"!==typeof e)throw new Error("Expected object");if(!ci[e.type])throw new Error("Expected valid pane, got: ".concat(e.type))}function vi(e){!function(e){if("object"!==typeof e)throw new Error("Expected object");Object.values(e).map(pi)}(e.data),fi(e.layout,Object.keys(e.data))}function hi(e){var t=e.isHTML,n=e.initialLayoutState,r=e.flagSaveLayoutState,i=e.flagLayoutTabs,o=(0,ei.Z)(),c=o.preferences,u=o.initiallyLoading,s=c.isLayoutStacked,d=(0,H.Z)(),f=(0,l.b9)(Wt.sq),p=(0,a.useRef)(!1);(0,a.useEffect)((function(){if(!p.current&&!u){var e=n?function(e){try{vi(e)}catch(t){return null}return e}(n):null,o=i&&r&&e?e:function(e){var t=e.isStacked,n=e.isHTML,r={filetree:{paneId:li()(),pane:{type:"filetree"}},codeEditor:{paneId:li()(),pane:{type:"codeEditor",data:{path:""}}},output:{paneId:li()(),pane:{type:n?"webview":"runnerOutput"}},shell:{paneId:li()(),pane:{type:"shell"}}},i={};return Object.values(r).forEach((function(e){var t=e.paneId,n=e.pane;i[t]=n})),{layout:function(e){var t=e.filetreeId,n=e.codeEditorId,r=e.outputId,i=e.shellId;return{floating:[],tiling:e.isStacked?{type:"split",stacked:!1,percent:100,children:[{percent:15,type:"paneGroup",panes:[t],activeIndex:0},{type:"split",stacked:!0,percent:85,children:[{percent:60,type:"paneGroup",panes:[n],activeIndex:0},{percent:40,type:"paneGroup",panes:[r,i],activeIndex:0}]}]}:{type:"split",stacked:!1,percent:100,children:[{percent:15,type:"paneGroup",panes:[t],activeIndex:0},{percent:45,type:"paneGroup",panes:[n],activeIndex:0},{percent:40,type:"paneGroup",panes:[r,i],activeIndex:0}]}}}({filetreeId:r.filetree.paneId,codeEditorId:r.codeEditor.paneId,outputId:r.output.paneId,shellId:r.shell.paneId,isStacked:t}),data:i}}({isStacked:s,isHTML:t}),a=o.data,l=o.layout;f({data:a,layout:l,replId:d,isSavedLayout:Boolean(e)}),p.current=!0}}),[f,u,s,d,n,t,r,i])}function yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mi(e,t,n[t])}))}return e}function bi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return yi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yi(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var wi=n(59936),Zi=n(91449),xi=n(50999),Ii=n(81605),Ei=n(56167),Si=n(86035),ki=n(62867),Ci=n(18292),Pi=n(53408);var Ai=n(12873),Oi=n(62996);function Di(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ri(e){return function(e){if(Array.isArray(e))return Di(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Di(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Di(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ji=n(73049),Ti=n(91272);function Mi(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function Gi(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Mi(o,r,i,a,l,"next",e)}function l(e){Mi(o,r,i,a,l,"throw",e)}a(void 0)}))}}function Ui(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function _i(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ui(o,r,i,a,l,"next",e)}function l(e){Ui(o,r,i,a,l,"throw",e)}a(void 0)}))}}var zi=n(38880),Fi=n(27754);function Bi(){var e=(0,zi.Z)(),t=e.showConfirm,n=e.showNotice,r=e.hideMessage,i=e.showError,o=(0,E.Z)().container;(0,a.useEffect)((function(){var e=o.onToast((function(e){e.startsWith("PANIC")||n(e,function(e){var t=e.length/.025+1e3;return Math.max(1e4,t)}(e))})),a=null,l=!1,c=o.onConnectionStateChanged((function(e){if(a&&(r(a),a=null),e===Fi.e.CONNECTED)return l=!0,void(a=t("Connected",1500));l&&(e!==Fi.e.CONNECTING?e!==Fi.e.DISCONNECTED||(a=i("Disconnected")):a=n("Reconnecting"))}));return function(){a&&r(a),e(),c()}}),[o,t,n,i,r])}var Ni=n(48390),Li=n(63431),Ki=n(56700),Wi=n(25108);function Vi(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function Xi(){var e,t,n=(0,H.Z)(),r=(0,E.Z)(),o=r.fs,l=r.session,c=(0,v.eGB)({variables:{id:n}}).data,u="Repl"===(null===c||void 0===c?void 0:c.repl.__typename)?c.repl:null,s="CurrentUser"===(null===c||void 0===c||null===(e=c.currentUser)||void 0===e?void 0:e.__typename)?c.currentUser:null,d="Repl"===(null===c||void 0===c?void 0:c.repl.__typename)&&c.repl.isModelSolutionFork,f=d?u&&(null===(t=u.origin)||void 0===t?void 0:t.origin):u&&u.origin||null,p=(0,ii.b)("Repl"===(null===f||void 0===f?void 0:f.__typename)?{repl:f,currentUser:s||void 0}:null);a.useEffect((function(){u&&s&&u.isProject&&o.stat(".lesson").then((function(e){e.exists||o.createDir(".lesson")}))}),[o,s,u]),a.useEffect((function(){if(u&&(u.isProjectFork||d)&&f&&p){var e=(0,Fi.Z)({onUnrecoverableError:function(e){Wi.error(e),Ae.$e((function(t){t.setTag("curriculum-authoring",!0),t.setExtra("originId",f.id),Ae.Tb(e)}))}}),t=(0,Ni.Z)({container:e});e.connect({context:p,fetchConnectionMetadata:function(){return(0,Li.Z)({url:"/data/repls/".concat(u.id,"/get_repl_origin_guest_connection_metadata")})}});var n=e.onConnectionStateChanged(function(){var r,a=(r=i().mark((function r(a){var c;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a!==Ki.e.CONNECTED){r.next=22;break}return n(),r.prev=2,r.next=5,o.copyDirFromRemote(".lesson",".lesson",t);case 5:if(!(c=r.sent).error){r.next=10;break}Ae.$e((function(e){e.setTag("curriculum-authoring",!0),e.setExtra("originId",f.id),Ae.Tb({message:"Error copying lesson: ".concat(c.error)})})),r.next=14;break;case 10:return r.next=12,o.stat(".lesson/instructions.md");case 12:r.sent.exists&&l.setInstructionsViewerVisible(!0);case 14:r.next=19;break;case 16:r.prev=16,r.t0=r.catch(2),Ae.$e((function(e){e.setTag("curriculum-authoring",!0),Ae.Tb(r.t0)}));case 19:return r.prev=19,e.destroy(),r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[2,16,19,22]])})),function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function a(e){Vi(o,n,i,a,l,"next",e)}function l(e){Vi(o,n,i,a,l,"throw",e)}a(void 0)}))});return function(e){return a.apply(this,arguments)}}());return function(){return e.destroy()}}}),[o,p,u,f,d,l])}var Hi=n(38835),qi=n(88229);function Yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Yi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yi(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Qi=n(92594),Ji={cmdOrCtrlKey:!0,altKey:!1,shiftKey:!0,key:"S"};function eo(){var e=(0,E.Z)().runner,t=(0,l.b9)(Te.im),n=(0,l.b9)(Te.Ky),r=(0,l.b9)(Te.ao),i=(0,Qi.Z)(),o=function(){var e=(0,E.Z)().session,t=$i(a.useState(e.getInstructionsViewerVisible()),2),n=t[0],r=t[1];return a.useEffect((function(){return r(e.getInstructionsViewerVisible()),e.onInstructionsViewerToggled(r)}),[e]),n}(),c=(0,me.e)(ge.H.Output);a.useEffect((function(){if(null===c||void 0===c?void 0:c.isActive){var e=setInterval((function(){t()}),200);return function(){clearInterval(e)}}}),[null===c||void 0===c?void 0:c.isActive,t]),a.useEffect((function(){return e.onStateChanged((function(e){e===Rr.A.RUNNING&&t()}))}),[e,t]);var u=(0,on.VV)();a.useEffect((function(){u||(i?n({type:"markdown",data:{path:i}}):r({type:"markdown"}))}),[i,n,r,u]),a.useEffect((function(){o?n({type:"instructions"}):r({type:"instructions"})}),[o,n,r]),(0,de.x)(Ji,{run:function(){return n({type:"shell"})}})}var to=n(68906),no=n(66306);function ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function io(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||ao(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oo(e){return function(e){if(Array.isArray(e))return ro(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ao(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ao(e,t){if(e){if("string"===typeof e)return ro(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ro(e,t):void 0}}function lo(e){var t,n=e.repl,r=e.currentUser,o=r.id===(null===(t=n.user)||void 0===t?void 0:t.id),u=(0,ei.Z)().preferences,s=(0,E.Z)().session;!function(){var e=(0,c.useRouter)(),t=(0,l.b9)(Q.j0);(0,a.useEffect)((function(){var n=function(){t()};return e.events.on("routeChangeStart",n),function(){e.events.off("routeChangeStart",n)}}),[])}(),function(){var e=(0,l.b9)(Te.qi),t=(0,E.Z)().session,n=(0,on.VV)();(0,a.useEffect)((function(){if(!n)return t.onSessionStateChanged(e)}),[t,e,n])}(),function(){var e=(0,E.Z)(),t=e.fs,n=e.dotReplit,r=e.session,o=(0,H.Z)(),l=(0,on.VV)();(0,a.useEffect)((function(){var e=function(){return a||r.getActiveFile()};if(!l){var a=!1;return function(){c.apply(this,arguments)}(),function(){a=!0}}function c(){return(c=Gi(i().mark((function a(){var l,c,u,s,d;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,ji.mv)(t);case 2:if(l=i.sent,!e()){i.next=5;break}return i.abrupt("return");case 5:if(!l.path){i.next=9;break}return r.openFile(l.path),l.line&&r.updateDeeplink({path:l.path,line:l.line,col:l.col}),i.abrupt("return");case 9:return i.next=11,(0,Ti.W)({replId:o,dotReplit:n,fs:t});case 11:if(c=i.sent,u=c.entrypoint,s=c.readmeFile,d=u||s,!e()&&d){i.next=17;break}return i.abrupt("return");case 17:r.openFile(d);case 18:case"end":return i.stop()}}),a)})))).apply(this,arguments)}}),[r,t,n,o,l])}(),(0,wi.Z)(),(0,Ii.Z)(),(0,to.Z)({workspaceType:"desktop"}),(0,Ei.Z)(),(0,Si.Z)(),(0,ki.Z)(),(0,Ci.Z)();var d=(0,Zi.Z)();(0,xi.Z)({isAnon:!1,isOwner:o,ignoreUnloadPrompt:d}),(0,Pi.Z)(),function(){var e=(0,E.Z)().presence,t=(0,_r.Z)();(0,a.useEffect)((function(){e.updateOpenFile(t)}),[e,t])}(),function(){var e=(0,E.Z)(),t=e.fs,n=e.session,r=(0,_r.Z)(),i=(0,on.VV)();(0,a.useEffect)((function(){if(!i&&r){var e=(0,Ln.Mb)(r)?t.watchOtFile:t.watchFile,o=!1,a=e(r,{onChange:function(){},onMoveOrDelete:function(e){if(e.eventType!==_n.kS.Move||e.to===Br.rq){var i=(0,Ln.Il)(r);t.readDir(i||Br.Ql).then((function(e){if(o)n.closeFile(r);else if(e.error)n.closeFile(r);else{var t=e.children.filter((function(e){return e.type===_n.Tv.File&&!(0,Ai.C)(e.filename)&&!Oi.nh.includes(e.filename)})).map((function(e){return e.filename}));if(0!==t.length){var a=Ri(t).concat([r]).sort(),l=a.indexOf(r),c=a[0===l?1:l-1],u=""===i?c:"".concat(i,"/").concat(c);n.openFile(u)}else n.closeFile(r)}}))}else n.openFile(e.to)}});return function(){o=!0,a()}}}),[t,r,n,i])}(),function(){var e=(0,E.Z)(),t=e.session,n=e.fs,r=(0,_r.Z)();a.useEffect((function(){var e=!1;function r(){return(r=_i(i().mark((function r(){var o,a;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.readDir(Br.Ql);case 2:if(!(o=r.sent).error){r.next=5;break}return r.abrupt("return");case 5:if(!e){r.next=7;break}return r.abrupt("return");case 7:if(a=o.children.find((function(e){return"readme.md"===e.filename.toLowerCase()}))){r.next=10;break}return r.abrupt("return");case 10:t.setPreviewedFile(a.filename);case 11:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),function(){e=!0}}),[t,n]),a.useEffect((function(){r&&"md"===(0,Ln.r6)(r)&&t.setPreviewedFile(r)}),[t,r])}(),Bi(),Xi(),(0,qi.Z)(),eo(),function(){var e=(0,c.useRouter)(),t=(0,E.Z)().container,n=io((0,l.KO)(no.a0),2),r=n[0],i=n[1],o=(0,l.b9)(no.Th);(0,a.useEffect)((function(){e.query.debug&&i(!0)}),[i,e.query.debug]),(0,a.useEffect)((function(){if(r)return t.client().onDebugLog((function(e){"log"===e.type&&o((function(t){return oo(t).concat([{index:t[t.length-1]?t[t.length-1].index+1:0,dir:e.log.direction,cmd:e.log.cmd,timestamp:window.performance.now()}])}))}))}),[r,o,t])}(),(0,Hi.Z)({onOpenFile:function(e){s.openFile(e.path),s.updateDeeplink(e)},onOutput:function(){}}),(0,on.ZP)();var f=["html","html_beta"].includes(n.language),p=(0,a.useRef)(n.layoutState||null);hi({isHTML:f,initialLayoutState:p.current,flagSaveLayoutState:Boolean(r.flagSaveLayoutState),flagLayoutTabs:Boolean(r.flagLayoutTabs)}),(0,a.useEffect)((function(){return Ae.YA("replId",n.id),function(){Ae.YA("replId",void 0)}}),[n.id]),function(e){var t=e.repl,n=e.currentUser,r=(0,E.Z)().container,i=(0,c.useRouter)(),o=(0,ii.b)({repl:t,currentUser:n});(0,a.useEffect)((function(){var e;return oi||(oi=!0,e=i.query.initialConnectionMetadata),r.connect({customConnectionMetadata:e,context:o}),function(){r.close()}}),[o,r]),(0,a.useEffect)((function(){return function(){r.destroy()}}),[r])}({repl:n,currentUser:r}),function(){var e=(0,H.Z)(),t=(0,E.Z)().container,n=(0,l.b9)(Te._N),r=bi((0,v.SrS)(),1)[0];(0,a.useEffect)((function(){return t.onPortOpened((function(t){var i=t.isVnc;n(i?"vnc":"webview"),r({variables:{input:gi({id:e},i?{isVnc:!0}:{isServer:!0})}})}))}),[t,n,r,e])}(),(0,a.useEffect)((function(){var e,t="Repl"===(null===(e=n.origin)||void 0===e?void 0:e.__typename)?n.origin.id:null;return(0,ri.Fy)({id:n.id,slug:n.slug,originId:t,roles:r.roles&&r.roles.map((function(e){return e.name}))}),function(){(0,ri.dv)()}}),[n,r.roles]);var h=(0,l.b9)(Q._E),y=(0,Jr.T)();(0,a.useEffect)((function(){h(!y)}),[y,h]);var m=(0,l.b9)(ti);(0,ni.Z)((function(){m(u.isLayoutStacked)}),[u.isLayoutStacked,m]);var g=u.isLayoutStacked,b=(0,l.b9)(Qn.h$);(0,a.useEffect)((function(){return b(g)}),[b,g]);var w=(0,l.b9)(Qn.gM);return(0,a.useEffect)((function(){return w(f)}),[w,f]),null}var co=n(5499);function uo(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function so(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){uo(o,r,i,a,l,"next",e)}function l(e){uo(o,r,i,a,l,"throw",e)}a(void 0)}))}}var fo=function(){var e=so(i().mark((function e(t,n){var r,o,a,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,ji.u9)()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,(0,ji.mv)(t);case 4:if(r=e.sent,o=r.path,a=r.line,l=r.col,o){e.next=10;break}return e.abrupt("return",!1);case 10:return n.openFile(o,{line:a,col:l}),e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function po(){var e=(0,E.Z)(),t=e.fs,n=e.session,r=e.dotReplit;return(0,co.Z)(t,n,r),null}function vo(){return function(){var e=(0,E.Z)(),t=e.fs,n=e.session,r=e.dotReplit,o=(0,H.Z)(),c=(0,a.useRef)(!1),u=(0,l.Dv)(Q.QP),s=(0,Ht.Z)(u),d=(0,Ht.Z)((0,l.Dv)(Wt.O4));(0,a.useEffect)((function(){if(u){var e=(0,ji.YM)({path:u}),t=window.location.hash;t===u||t.startsWith(e+":")||(c.current=!0,window.location.hash=e)}}),[u]),(0,a.useEffect)((function(){function e(){return(e=so(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.current){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fo(t,n);case 4:if(!e.sent){e.next=7;break}return e.abrupt("return");case 7:if(!d.current){e.next=9;break}return e.abrupt("return");case 9:(0,co.P)(t,n,r,o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,n,r,o,s,d]),(0,a.useEffect)((function(){var e=function(){var e=so(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.current){e.next=3;break}return c.current=!1,e.abrupt("return");case 3:return e.next=5,fo(t,n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return window.addEventListener("hashchange",e),function(){window.removeEventListener("hashchange",e)}}),[t,n])}(),null}function ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||go(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mo(e){return function(e){if(Array.isArray(e))return ho(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||go(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function go(e,t){if(e){if("string"===typeof e)return ho(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ho(e,t):void 0}}var bo=function(e){return"iframe-extensions/".concat(e)};function wo(){var e=yo(a.useState(!1),2),t=e[0],n=e[1],r=(0,$r.Z)("flag-iframe-extensions"),i=(0,H.Z)(),c=(0,l.b9)(J.g2),u=a.useCallback((function(e){c({pane:{data:{extensionUrl:e},type:"extension"},makeActive:!0,placement:"rightOf"})}),[c]);return a.useEffect((function(){if(r&&!t){var e=ft.Z.get(bo(i),"array");(null===e||void 0===e?void 0:e.length)&&(e.forEach(u),n(!0))}}),[r,i,u,t]),(0,ce.Y)({match:se.pl,data:{type:"action",label:"Add extension",icon:(0,o.tZ)(Fn.Z,{}),description:"Add an extension",run:function(){var e,t=prompt("insert extension url");t&&(u(t),ft.Z.set(bo(i),mo(null!==(e=ft.Z.get(bo(i),"array"))&&void 0!==e?e:[]).concat([t])))}}},{enabled:r}),null}var Zo=(0,l.cn)((function(e){var t=e(Qn.gr),n=e(Q.g4),r=(0,lt.K)(n,t),i="paneGroup"===(null===r||void 0===r?void 0:r.type)||"floatingPaneGroup"===(null===r||void 0===r?void 0:r.type)?r.panes[0]:null;if(!i)return null;var o=e((0,Q.z)(i)).rect,a=e(Q.M0);return{x:o.x,y:o.y-a,width:o.width,height:o.height+a}}));function xo(){var e=(0,l.Dv)(Zo),t=(0,Wn.Z)();return e&&t?(0,o.tZ)("div",{css:[rt.l0.position.absolute,rt.l0.width(e.width),rt.l0.height(e.height),rt.l0.borderRadius(4),{boxShadow:"0 0 0 3px ".concat(t.color),pointerEvents:"none",zIndex:3,transform:"translate(".concat(Math.round(e.x),"px, ").concat(Math.round(e.y),"px)")}]}):null}var Io=(0,a.memo)(xo);function Eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function So(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(r,i)}function ko(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){l=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Eo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Co(e){var t=e.repl,n=e.currentUser,r=function(e){var t=e.repl,n=e.flagLayoutTabs,r=(0,c.useRouter)(),i=(0,l.b9)(Q.tt),o=(0,l.b9)(Te.Up);return{services:(0,a.useState)((function(){return(0,Oe.Z)({runnerMode:"html"===t.language?"html":"shellrunner",onUnrecoverableError:function(e){if(e.message.toLowerCase().includes("repl not found"))r.push("/home","~/");else{var t={replenvironmentservices:!0,layoutv2:!0};Me.error(e),Ae.Tb(e,{tags:t});var n=(0,je.Z)(e,{tags:t});i(n)}},openFile:n?o:void 0})}))[0],ui:(0,a.useState)((function(){return(0,Re.fK)({config:(0,De.U)()})}))[0]}}({repl:t,flagLayoutTabs:n.flagLayoutTabs}),i=r.services,u=r.ui;return(0,o.BX)(jt,{ui:u,services:i,replId:t.id,children:[(0,o.tZ)(de.h,{}),(0,o.tZ)(Ur,{}),(0,o.tZ)(br.Z,{}),(0,o.tZ)(Pe,{}),(0,o.tZ)(ce.Z,{}),n.flagLayoutTabs?(0,o.tZ)(vo,{}):(0,o.tZ)(po,{}),(0,o.tZ)(lo,{repl:t,currentUser:n}),(0,o.tZ)(Vr.Z,{}),(0,o.BX)(h.G7,{css:[h.l0.flex.row,h.l0.flex.growAndShrink(1)],children:[(0,o.tZ)(h.G7,{css:[h.l0.py(8),h.l0.pl(8)],children:(0,o.tZ)(Pt,{})}),(0,o.tZ)(Do,{})]}),(0,o.tZ)(kr.Z,{container:i.container}),(0,o.tZ)(Wr,{}),(0,o.tZ)(Qr,{}),(0,o.tZ)(Ao,{isMultiplayerSession:t.multiplayers.length>0}),(0,o.tZ)(Po,{image:n.image,username:n.username}),(0,o.tZ)(wo,{})]})}function Po(e){var t=e.image,n=e.username,r=ko((0,l.KO)(Q.tt),2),i=r[0],a=r[1];return i?(0,o.tZ)(u.Z,{devHide:function(){return a(null)},eventId:i,currentUserImage:t,currentUserUsername:n}):null}function Ao(e){var t=Sr(e.isMultiplayerSession),n=t.shouldShowModal,r=t.hideModal,i=t.confirm;return n?(0,o.tZ)(m.Z,{onCancel:r,onConfirm:i}):null}var Oo=(0,h.KD)("div");function Do(){var e=function(){var e=(0,l.b9)(Q.rR),t=(0,a.useRef)(null),n=(0,gr.Z)((function(n){var r=n.width,i=n.height;if(r&&i&&t.current){var o=t.current.getBoundingClientRect(),a=o.top,l=o.left;e({width:r,height:i,x:l,y:a})}}));return(0,a.useCallback)((function(e){t.current=e,n(e)}),[n])}(),t=(0,l.Dv)(Q.nJ),n=(0,l.Dv)(Q.gg),r=(0,l.Dv)(Q.g3),i=(0,l.Dv)(Q.If);return(0,o.tZ)(h.G7,{css:[h.l0.position.relative,h.l0.flex.growAndShrink(1)],children:(0,o.tZ)(Oo,{ref:e,css:[h.l0.position.absolute,h.l0.top(8),h.l0.left(0),h.l0.width("calc(100% - (".concat(8,"px))")),h.l0.height("calc(100% - (".concat(8,"px * 2))"))],children:t?(0,o.BX)(o.HY,{children:[r.map((function(e){return(0,o.tZ)(Rn,{handleId:e},e)})),i.map((function(e){return(0,o.tZ)(lr,{headerId:e},e)})),n.map((function(e){return(0,o.tZ)(Sn,{paneId:e},e)})),(0,o.tZ)(mr,{}),(0,o.tZ)(Io,{})]}):null})})}var Ro=function(){var e=null,t=(0,c.useRouter)().query;if(!t.replUrl)throw new Error("Expected replUrl to be set");var n=t.replUrl.toString(),r=(0,v.CdZ)({variables:{url:n},ssr:Boolean(t.ssr)}),i=r.data,l=r.loading,u=r.error,s=i&&"Repl"===i.repl.__typename?i.repl:null,f=(null===i||void 0===i?void 0:i.currentUser)||void 0,m="https://replit.com".concat(n),b=function(e){if(e){if(e.description)return e.description;var t=p().get(e.language).displayName;return"A ".concat(t," Repl")}}(s),w=(0,a.useState)(!1),Z=w[0],x=w[1];return(0,a.useEffect)((function(){return x(!0)}),[]),(0,a.useEffect)(y.S,[]),function(e){var t=(0,c.useRouter)(),n=e&&"Repl"===e.repl.__typename?e.repl:null;if(!t.query.replUrl)throw new Error("Expected replUrl to be set.");var r=t.query.replUrl.toString();(0,a.useEffect)((function(){n&&p().get(n.language).isDeprecated&&t.replace({pathname:"/deprecatedLangauge",query:{replId:n.id}},t.asPath)}),[n,t]),(0,a.useEffect)((function(){if(e&&e.repl&&"SubscriptionExpiredError"===e.repl.__typename){var n=e.repl,i=n.replId,o=n.isOwner,a=r.split("/")[1].slice(1);t.replace({pathname:"/expiredPrivateRepl",query:{isOwner:o,ownerUsername:a,replId:i}},t.asPath)}}),[e,t,r])}(i),e=u?(0,o.tZ)(h.G7,{css:[h.l0.center,h.l0.flex.growAndShrink(1)],children:(0,o.tZ)(h.xv,{children:"Something went wrong loading the Repl. Please reload the page and try again."})}):l||!Z?(0,o.tZ)(h.G7,{css:[h.l0.center,h.l0.flex.growAndShrink(1)],children:(0,o.tZ)(Ge.Z,{size:32})}):s&&f?(0,o.tZ)(Co,{repl:s,currentUser:f}):(0,o.tZ)(h.G7,{css:[h.l0.center,h.l0.flex.growAndShrink(1)],children:(0,o.tZ)(Ge.Z,{size:32})}),(0,o.tZ)(ge.E,{hideTour:!f,children:(0,o.tZ)(g.Z,{children:(0,o.tZ)(d.Z,{title:"".concat((null===s||void 0===s?void 0:s.title)||""),oembedUrl:m,description:b,noHeader:!0,noFooter:!0,forceDrawer:!0,hideSidebar:!0,hideEmailVerify:!0,children:(0,o.tZ)(h.Tg,{css:[h.l0.height("100vh"),h.l0.width("100vw"),h.l0.overflow("hidden")],children:e})})})})};Ro.getInitialProps=function(){var e,t=(e=i().mark((function e(t){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.req,r=t.store,e.next=3,(0,s.Z)(n,r);case 3:return e.abrupt("return",{});case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){So(o,r,i,a,l,"next",e)}function l(e){So(o,r,i,a,l,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();var jo=Ro}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[5762,8350,3443,2240,3662,6344,6351,7851,2167,8966,4778,4969,9998,8944,3981,7529,9710,3220,3319,9850,4837,5225,3129,1674,9761,2799,9114,1948,1700,6067,8534,8099,2694,9799,9164,6871,5578,6673,876,9369,8795,700,6571,4989,8271,3298,3652,9774,2888,179],(function(){return t(97239),t(44725)}));var n=e.O();_N_E=n}]);
//# sourceMappingURL=replEnvironment2-dcec8fa309d76985.js.map